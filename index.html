<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Network Checker</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background:#f5f5f5; padding:20px;
    }
    .card {
      background:#fff; padding:20px; border-radius:10px;
      max-width:600px; margin:auto; box-shadow:0 4px 8px rgba(0,0,0,.1);
    }
    h1 { text-align:center; margin-bottom:20px; }
    .ip-list { margin-top:15px; }
    .ip-item {
      padding:8px 10px; margin:6px 0; background:#f1f5f9;
      border-radius:6px; display:flex; justify-content:space-between;
    }
    .badge { font-size:12px; background:#e2e8f0; padding:4px 8px; border-radius:12px; }
    button { margin-top:15px; padding:10px 14px; border:0; border-radius:6px;
      background:#3498db; color:#fff; cursor:pointer; }
  </style>
</head>
<body>
  <div class="card">
    <h1>Network Checker</h1>
    <div id="status">Klik tombol untuk deteksi IP privat...</div>
    <div class="ip-list" id="ipList"></div>
    <button onclick="detectIPs()">Deteksi Sekarang</button>
  </div>

  <script>
    async function detectIPs() {
      const status = document.getElementById("status");
      const ipList = document.getElementById("ipList");
      ipList.innerHTML = "";
      status.textContent = "Mendeteksi...";

      const RTCPeerConnection = window.RTCPeerConnection || window.webkitRTCPeerConnection;
      if (!RTCPeerConnection) {
        status.textContent = "Browser tidak mendukung WebRTC.";
        return;
      }

      const ips = new Set();
      let mdnsObserved = false;

      const pc = new RTCPeerConnection({iceServers:[]});
      pc.createDataChannel("test");

      pc.onicecandidate = (event) => {
        if (!event.candidate) return;
        const cand = event.candidate.candidate;

        if (cand.includes(".local")) mdnsObserved = true;

        const regex = /([0-9]{1,3}(\.[0-9]{1,3}){3})/;
        const match = cand.match(regex);
        if (match) {
          const ip = match[1];
          if (ip !== "127.0.0.1") ips.add(ip);
        }
      };

      await pc.setLocalDescription(await pc.createOffer());
      await new Promise(r => setTimeout(r, 1500));
      pc.close();

      ipList.innerHTML = "";
      if (mdnsObserved) {
        status.textContent = "Browser menyamarkan alamat lokal (mDNS).";
      } else if (ips.size === 0) {
        status.textContent = "Tidak ada IP privat terdeteksi.";
      } else {
        status.textContent = "IP privat yang terdeteksi:";
        ips.forEach(ip => {
          const div = document.createElement("div");
          div.className = "ip-item";
          div.innerHTML = `<span>${ip}</span><span class="badge">Private</span>`;
          ipList.appendChild(div);
        });
      }
    }
  </script>
</body>
</html>
